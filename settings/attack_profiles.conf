# attack_profiles.conf:
# ---------------------
# [<profile-name>]
# description = short text describing the profile (mandatory)
# <service_name> = <ordered list of checks to run>



#########################################################################################
# Weak creds
#########################################################################################
[weak-creds]
description = Quickly check for weak/common/default credentials (quick bruteforce)

ajp = default-creds-tomcat
ftp = default-creds
http = default-creds-web-multi, default-creds-appserver
java-rmi = jmx-default-creds
mssql = default-creds
mysql = default-creds
oracle = default-creds
postgresql = default-creds
smtp = smtp-user-enum
snmp = default-community-strings
ssh = default-ssh-key, default-creds
telnet = default-creds
vnc = default-creds


#########################################################################################
# Bruteforce
#########################################################################################
[bruteforce]
description = Perform advanced bruteforce on services (can take long time)

ajp = 
    default-creds-tomcat
ftp = 
    default-creds, 
    bruteforce-creds
http = 
    bruteforce-htaccess,
    bruteforce-appserver,
    bruteforce-domino, 
    bruteforce-wordpress, 
    bruteforce-joomla, 
    bruteforce-drupal, 
    bruteforce-opencart, 
    bruteforce-magento
java-rmi = 
    jmx-common-creds, 
    jmx-bruteforce
mssql = 
    common-creds, 
    bruteforce-sa-account
mysql = 
    default-creds, 
    bruteforce-root-account
oracle = 
    common-creds, 
    bruteforce-creds
postgresql = 
    default-creds, 
    bruteforce-postgres-account
snmp = 
    common-community-strings,
    snmpv3-bruteforce-creds
smtp =
    smtp-user-enum
ssh = 
    default-ssh-key, 
    common-creds
telnet = 
    default-creds, 
    bruteforce-root-account
vnc = 
    common-pass, 
    bruteforce-pass


#########################################################################################
# Fast-scan
#########################################################################################
[fast-scan]
description = Perform only fast checks

ajp = 
    nmap-recon, 
    tomcat-version, 
    cvedetails-lookup, 
    default-creds-tomcat, 
    deploy-webshell-tomcat

ftp = 
    nmap-recon, 
    ftpmap-scan, 
    cvedetails-lookup, 
    common-creds, 
    ftp-dirlisting

http = 
    #nmap-recon, 
    #waf-detection, 
    fingerprinting-multi-whatweb, 
    fingerprinting-appserver, 
    webdav-detection-msf,
    fingerprinting-cms-cmseek,
    fingerprinting-drupal,
    fingerprinting-domino,
    crawling-fast,
    crawling-fast2,
    cvedetails-lookup,
    #ssl-check,
    #vulnscan-multi-nikto,
    default-creds-web-multi,
    default-creds-appserver,
    webdav-scan-davscan,
    webdav-internal-ip-disclosure,
    webdav-website-content,
    http-put-check,
    shellshock-scan,
    iis-shortname-scan,
    iis-internal-ip-disclosure,
    tomcat-user-enum,
    jboss-vulnscan-multi,
    jboss-status-infoleak,
    jenkins-infoleak,
    wordpress-vulnscan,
    #wordpress-vulnscan2,
    joomla-vulnscan,
    drupal-vulnscan,
    magento-vulnscan,
    silverstripe-vulnscan,
    vbulletin-vulnscan,
    liferay-vulnscan,
    angularjs-csti-scan,
    struts2-rce-cve2017-5638,
    struts2-rce-cve2017-9791,
    struts2-rce-cve2017-9805,
    struts2-rce-cve2018-11776,
    rails-rce-cve2019-5420,
    appserver-auth-bypass,
    jboss-misconfig-exploit,
    tomcat-rce-cve2017-12617,
    jenkins-cli-deserialize-cve2015-8103,
    jenkins-groovy-xml-rce-cve2016-0792,
    weblogic-t3-open-jdbc-datasource,
    weblogic-t3-deserialize-cve2015-4852,
    weblogic-t3-deserialize-cve2016-3510,
    weblogic-t3-deserialize-cve2017-3248,
    weblogic-t3-deserialize-cve2018-2628,
    weblogic-t3-deserialize-cve2018-2893,
    weblogic-rce-cve2018-2894,
    weblogic-wls-wsat-cve2017-10271,
    websphere-deserialize-cve2015-7450,
    drupal-cve-exploit,
    joomla-comfields-sqli-rce,
    appserver-postauth-deploy,
    wordpress-shell-upload

java-rmi = 
    nmap-recon,
    rmi-enum,
    jmx-info,
    jmx-common-creds,
    exploit-rmi-default-config,
    exploit-jmx-insecure-config,
    jmx-auth-disabled-deploy-class,
    tomcat-jmxrmi-deserialize,
    rmi-deserialize-all-payloads,
    tomcat-jmxrmi-manager-creds

jdwp =
    nmap-recon,
    jdwp-rce

mssql =
    nmap-recon,
    mssqlinfo,
    cvedetails-lookup,
    common-creds,
    audit-mssql-postauth,
    audit-mssql-shellexec

mysql =
    nmap-recon,
    cvedetails-lookup,
    mysql-auth-bypass-cve2012-2122,
    default-creds,
    mysql-hashdump,
    mysql-interesting-tables-columns

oracle =
    tnscmd,
    cvedetails-lookup,
    tnspoisoning,
    common-creds,
    audit-oracle-postauth,
    search-columns-passwords

postgresql =
    cvedetails-lookup,
    default-creds

rdp =
    ms12-020

smb =
    nmap-recon,
    anonymous-enum-smb,
    detect-ms17-010,
    samba-rce-cve2015-0240,
    exploit-rce-ms08-067,
    exploit-rce-ms17-010-eternalblue,
    exploit-sambacry-rce-cve2017-7494,
    auth-enum-smb,
    auth-shares-perm,
    smb-exec

smtp =
    smtp-cve,
    smtp-user-enum
    
snmp =
    common-community-strings,
    enumerate-info

ssh = 
    cvedetails-lookup,
    user-enumeration-timing-attack,
    auth-bypass-libssh-cve2018-10933,
    default-ssh-key,
    common-creds

telnet = 
    nmap-recon,
    default-creds

vnc = 
    nmap-recon,
    common-pass


#########################################################################################
# Banner vuln
#########################################################################################
[banner-vuln]
description = Perform online vulnerabilities lookup when product name and version are known

ajp = tomcat-version, vulners-lookup, cvedetails-lookup
ftp = vulners-lookup, cvedetails-lookup
http = vulners-lookup, cvedetails-lookup
mssql = vulners-lookup, cvedetails-lookup
mysql = vulners-lookup, cvedetails-lookup
oracle = vulners-lookup, cvedetails-lookup
postgresql = vulners-lookup, cvedetails-lookup
ssh = vulners-lookup, cvedetails-lookup


#########################################################################################
# Web Server Scan
#########################################################################################
[web-server-scan]
description = Perform checks on web/app servers only

http = 
    fingerprinting-appserver,
    fingerprinting-server-domino,
    default-creds-web-multi,
    default-creds-appserver,
    webdav-scan-davscan,
    webdav-internal-ip-disclosure,
    webdav-website-content,
    iis-shortname-scan,
    tomcat-user-enum,
    jboss-vulnscan-multi,
    jboss-status-infoleak,
    jenkins-infoleak,
    rails-rce-cve2019-5420,
    appserver-auth-bypass,
    jboss-misconfig-exploit,
    tomcat-rce-cve2017-12617,
    jboss-deserialize-cve2015-7501,
    jenkins-unauthenticated-console,
    jenkins-cli-deserialize-cve2015-8103,
    jenkins-cli-deserialize2-cve2015-8103,
    jenkins-groovy-xml-rce-cve2016-0792,
    weblogic-t3-open-jdbc-datasource,
    weblogic-t3-deserialize-cve2015-4852,
    weblogic-t3-deserialize-cve2016-3510,
    weblogic-t3-deserialize-cve2017-3248,
    weblogic-t3-deserialize-cve2018-2628,
    weblogic-t3-deserialize-cve2018-2893,
    weblogic-rce-cve2018-2894,
    weblogic-wls-wsat-cve2017-10271,
    websphere-deserialize-cve2015-7450,
    iis-webdav-win2003-bof

#########################################################################################
# Web CMS Scan
#########################################################################################
[web-cms-scan]
description = Perform checks on web CMS only

http =
    fingerprinting-cms-wig,
    fingerprinting-cms-cmseek,
    fingerprinting-cms-fingerprinter,
    fingerprinting-drupal,
    fingerprinting-domino,
    cms-multi-vulnscan-cmsmap,
    wordpress-vulnscan,
    wordpress-vulnscan2,
    joomla-vulnscan,
    joomla-vulnscan2,
    joomla-vulnscan3,
    drupal-vulnscan,
    magento-vulnscan,
    silverstripe-vulnscan,
    vbulletin-vulnscan,
    liferay-vulnscan,
    drupal-cve-exploit,
    joomla-comfields-sqli-rce

